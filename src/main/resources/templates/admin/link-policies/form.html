<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
  <meta charset="UTF-8"/>
  <title>링크 정책 추가</title>
  <link rel="stylesheet" th:href="@{/css/admin-style.css}" />
  <style>
    :root { --primary:#4F46E5; --muted:#f6f7fb; --danger:#dc2626; --border:#e5e7eb; }
    body { font-family: ui-sans-serif, system-ui, -apple-system, "Segoe UI", Roboto; background:#fff; color:#111827; }
    .admin-shell { display:grid; grid-template-columns: 260px 1fr; min-height:100vh; }
    main.admin-content { padding:24px; }
    .container{ max-width:800px; margin:0 auto; }
    .titlebar{ display:flex; justify-content:space-between; align-items:center; margin-bottom:16px; }
    .title{ font-size:22px; font-weight:800; margin:0; }
    .card{ background:#fff; border:1px solid var(--border); border-radius:16px; padding:24px; box-shadow:0 6px 18px rgba(0,0,0,.04); }
    .form-group{ margin-bottom:20px; }
    .form-label{ display:block; font-weight:700; margin-bottom:8px; color:#374151; }
    .form-input{ width:100%; padding:12px 16px; border:1px solid var(--border); border-radius:10px; font-size:14px; }
    .form-input:focus{ outline:none; border-color:var(--primary); box-shadow:0 0 0 3px rgba(79,70,229,.1); }
    .form-help{ font-size:12px; color:#6b7280; margin-top:4px; }
    .btn{ padding:12px 20px; border-radius:10px; border:1px solid var(--border); background:#fff; cursor:pointer; text-decoration:none; display:inline-block; font-weight:600; }
    .btn-primary{ background:var(--primary); color:#fff; border-color:var(--primary); }
    .btn-secondary{ background:#f8f9fa; color:#6b7280; border-color:var(--border); }
    .btn-group{ display:flex; gap:12px; margin-top:24px; }
    .toast { margin-bottom:16px; padding:12px 16px; border-radius:10px; }
    .toast.success { background:#f0fdf4; border:1px solid #bbf7d0; color:#166534; }
    .toast.error { background:#fef2f2; border:1px solid #fecaca; color:#dc2626; }
    .example-box{ background:#f8f9fa; padding:16px; border-radius:8px; margin-top:12px; }
    .example-box h4{ margin:0 0 8px 0; font-size:14px; color:#374151; }
    .example-box ul{ margin:0; padding-left:20px; color:#6b7280; font-size:13px; }
    .example-box code{ background:#e5e7eb; padding:2px 6px; border-radius:4px; font-family:monospace; font-size:12px; }
  </style>
</head>
<body>
<div class="admin-shell">
  <!-- 사이드바 -->
  <div th:replace="~{admin/fragments/sidebar :: sidebar(${#execInfo.templateName})}"></div>

  <!-- 본문 -->
  <main class="admin-content">
    <div class="container">
      <div class="titlebar">
        <h1 class="title">링크 정책 추가</h1>
        <a th:href="@{/admin/link-policies}" class="btn btn-secondary">목록으로</a>
      </div>

      <div th:if="${message}" class="toast success" th:text="${message}">성공 메시지</div>
      <div th:if="${error}" class="toast error" th:text="${error}">오류 메시지</div>

      <div class="card">
        <form th:action="@{/admin/link-policies}" method="post" th:object="${policy}">
          <input type="hidden" th:if="${_csrf != null}" th:name="${_csrf.parameterName}" th:value="${_csrf.token}"/>
          
          <div class="form-group">
            <label for="pattern" class="form-label">차단할 패턴 *</label>
            <input type="text" 
                   id="pattern" 
                   name="pattern" 
                   th:field="*{pattern}"
                   class="form-input" 
                   placeholder="예: malicious.com, evil.org, spam.net"
                   required
                   maxlength="255"/>
            <div class="form-help">
              이 패턴이 포함된 URL은 상품 등록 시 차단됩니다. 부분 문자열 매칭으로 작동합니다.
            </div>
          </div>

          <div class="example-box">
            <h4>패턴 예시</h4>
            <ul>
              <li><code>malicious.com</code> → <code>https://malicious.com/evil</code> 차단</li>
              <li><code>evil.org</code> → <code>https://www.evil.org/attack</code> 차단</li>
              <li><code>spam</code> → <code>https://spam-site.com</code> 차단</li>
              <li><code>phishing</code> → <code>https://phishing-trap.net</code> 차단</li>
            </ul>
          </div>

          <div class="btn-group">
            <button type="submit" class="btn btn-primary">정책 추가</button>
            <a th:href="@{/admin/link-policies}" class="btn btn-secondary">취소</a>
          </div>
        </form>
      </div>
    </div>
  </main>
</div>
</body>
</html>
